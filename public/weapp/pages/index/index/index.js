(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index/index","components/diy-live/diy-live"],{"199b":function(e,t,n){},"2c39":function(e,t,n){"use strict";var i=n("199b"),o=n.n(i);o.a},"3dd0":function(e,t,n){"use strict";n.r(t);var i=n("e856"),o=n("b011");for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("a82f"),n("8c28");var r,u=n("f0c5"),c=Object(u["a"])(o["default"],i["b"],i["c"],!1,null,"74734345",null,!1,i["a"],r);t["default"]=c.exports},"62b4":function(e,t,n){},"65c3":function(e,t,n){"use strict";(function(e){n("6b76");i(n("66fd"));var t=i(n("eff4"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},"76f2":function(e,t,n){},"8c28":function(e,t,n){"use strict";var i=n("76f2"),o=n.n(i);o.a},"96c1":function(e,t,n){},a6c5:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n("4795")),o=(a(n("eab3")),a(n("3dd0")),n("bfe4"),a(n("4c22")));function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,i,o,a,r){try{var u=e[a](r),c=u.value}catch(s){return void n(s)}u.done?t(c):Promise.resolve(c).then(i,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function u(e){r(a,i,o,u,c,"next",e)}function c(e){r(a,i,o,u,c,"throw",e)}u(void 0)}))}}var c=function(){Promise.all([n.e("common/vendor"),n.e("components/ns-show-toast/ns-show-toast")]).then(function(){return resolve(n("f505"))}.bind(null,n)).catch(n.oe)},s=function(){n.e("components/uni-popup/uni-popup").then(function(){return resolve(n("d380"))}.bind(null,n)).catch(n.oe)},l=function(){n.e("components/diy-bottom-nav/diy-bottom-nav").then(function(){return resolve(n("10f0"))}.bind(null,n)).catch(n.oe)},d=function(){n.e("components/diy-index-page/diy-index-page").then(function(){return resolve(n("77f1"))}.bind(null,n)).catch(n.oe)},f=function(){n.e("components/diy-group/diy-group").then(function(){return resolve(n("967f"))}.bind(null,n)).catch(n.oe)},g=function(){n.e("components/ns-navbar/ns-navbar").then(function(){return resolve(n("77f7"))}.bind(null,n)).catch(n.oe)},h={components:{uniPopup:s,diyBottomNav:l,nsShowToast:c,nsNavbar:g,diyIndexPage:d,diyGroup:f},data:function(){return{diyData:{},siteInfo:null,memberId:0,id:0,store:{},storeId:0,latitude:null,longitude:null,showStore:!1,isIphoneX:!1,pageHeight:"0",headerHeight:"0",bottomHeight:"0",popWindowBox:null,topIndexValue:null}},onPullDownRefresh:function(){this.getDiyInfo()},watch:{storeId:function(){this.$forceUpdate()}},onLoad:function(t){if(e.hideTabBar(),this.isIphoneX=this.$util.uniappIsIPhoneX(),t.source_member&&e.setStorageSync("source_member",t.source_member),t.scene){var n=decodeURIComponent(t.scene);n=n.split("&"),n.length&&n.forEach((function(t){-1!=t.indexOf("source_member")&&e.setStorageSync("source_member",t.split("-")[1])}))}this.getHeight()},onShow:function(){var t=this;return u(i.default.mark((function n(){return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.store=e.getStorageSync("store")?e.getStorageSync("store"):{},t.store&&(t.storeId=t.store.store_id),t.$langConfig.refresh(),e.getStorageSync("token")&&t.getMemberId(),t.getDefaultImg(),t.getDiyInfo();case 6:case"end":return n.stop()}}),n)})))()},mixins:[o.default],computed:{top:function(){var e=0;return e=this.isIphoneX?180:140,e},bgColor:function(){var e="";return this.diyData&&this.diyData.global&&(e=this.diyData.global.bgColor),e},bgUrl:function(){var e="";return this.diyData&&this.diyData.global&&(e=this.diyData.global.bgUrl),e},bgNav:function(){return this.bgUrl?{background:"url("+this.$util.img(this.bgUrl)+") no-repeat 0 0/100%"}:this.bgColor?{background:this.bgColor}:{background:"#ffffff"}},scrollHeight:function(){return void 0!=this.pageHeight&&void 0!=this.headerHeight&&void 0!=this.bottomHeight?"calc("+this.pageHeight+" - "+this.headerHeight+" - "+this.bottomHeight+")":"100vh"},scrollTopHeight:function(){return void 0!=this.pageHeight&&void 0!=this.headerHeight&&void 0!=this.bottomHeight?"calc("+this.pageHeight+" - "+this.headerHeight+" - "+this.bottomHeight+" - 80rpx)":"100vh"}},methods:{getHeight:function(){var t=this;e.getSystemInfo({success:function(e){console.log(e.windowHeight),t.pageHeight=e.windowHeight+"px",console.log({pageHeight:t.pageHeight})}}),this.$nextTick((function(){var n=e.createSelectorQuery().in(t);n.select(".page-header").boundingClientRect((function(e){t.headerHeight=e.height+"px",console.log({headerHeight:t.headerHeight})})).exec()})),this.$nextTick((function(){var n=e.createSelectorQuery().in(t);n.select(".page-bottom").boundingClientRect((function(e){t.bottomHeight="55px"})).exec()}))},getDiyInfo:function(){var t=this;this.$api.sendRequest({url:"/api/diyview/info",data:{name:"DIYVIEW_INDEX"},success:function(n){if(0!=n.code||!n.data)return t.$refs.loadingCover&&t.$refs.loadingCover.hide(),void(t.diyData={});var i=n.data;if(i.value){t.diyData=JSON.parse(i.value);for(var o=0;o<t.diyData.value.length;o++)"TopCategory"==t.diyData.value[o].controller&&(t.topIndexValue=t.diyData.value[o]),"PopWindow"==t.diyData.value[o].controller&&(t.popWindowBox=t.diyData.value[o],t.popWindowBox.imageUrl=t.$util.img(t.popWindowBox.imageUrl),setTimeout((function(){if(null!=e.getStorageSync("index_wap_floating_layer")&&""!=e.getStorageSync("index_wap_floating_layer")){var n=JSON.parse(e.getStorageSync("index_wap_floating_layer"));n.closeNum<Number(t.diyData.value[o].showCount)&&t.$refs.uniPopupWindow.open()}else t.$refs.uniPopupWindow.open()}),500))}e.stopPullDownRefresh(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()},fail:function(e){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})},closeNum:function(){this.$refs.uniPopupWindow.close();var t=1;if(e.getStorageSync("index_wap_floating_layer")){var n=JSON.parse(e.getStorageSync("index_wap_floating_layer"));t=++n.closeNum}e.setStorageSync("index_wap_floating_layer",JSON.stringify({closeNum:t}))},redirectTo:function(e){this.$util.diyRedirectTo(e)},getDefaultImg:function(){this.$api.sendRequest({url:"/api/config/defaultimg",success:function(t){var n=t.data;0==t.code&&n&&e.setStorageSync("default_img",JSON.stringify(n))}})},getMemberId:function(){var e=this;this.$api.sendRequest({url:"/api/member/id",success:function(t){t.code>=0&&(e.memberId=t.data)}})},onShareAppMessage:function(e){var t="";this.siteInfo&&(t=this.siteInfo.site_name);var n="/pages/index/index/index";return this.memberId&&(n+="?source_member="+this.memberId),{title:t,path:n,success:function(e){},fail:function(e){}}}},onReady:function(){}};t.default=h}).call(this,n("543d")["default"])},a82f:function(e,t,n){"use strict";var i=n("62b4"),o=n.n(i);o.a},a8fe:function(e,t,n){"use strict";n.r(t);var i=n("a6c5"),o=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a},abfc:function(e,t,n){"use strict";var i=n("96c1"),o=n.n(i);o.a},b011:function(e,t,n){"use strict";n.r(t);var i=n("e7be"),o=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a},bded:function(e,t,n){"use strict";var i={nsNavbar:function(){return n.e("components/ns-navbar/ns-navbar").then(n.bind(null,"77f7"))},diyIndexPage:function(){return n.e("components/diy-index-page/diy-index-page").then(n.bind(null,"77f1"))},diyGroup:function(){return n.e("components/diy-group/diy-group").then(n.bind(null,"967f"))},uniPopup:function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"d380"))},diyBottomNav:function(){return n.e("components/diy-bottom-nav/diy-bottom-nav").then(n.bind(null,"10f0"))},loadingCover:function(){return n.e("components/loading-cover/loading-cover").then(n.bind(null,"cd2f"))},nsShowToast:function(){return Promise.all([n.e("common/vendor"),n.e("components/ns-show-toast/ns-show-toast")]).then(n.bind(null,"f505"))}},o=function(){var e=this,t=e.$createElement,n=(e._self._c,e.$util.img(e.bgUrl));e.$mp.data=Object.assign({},{$root:{g0:n}})},a=[];n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}))},e7be:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={components:{},name:"diy-live",props:{value:{type:Object,default:function(){return{}}}},data:function(){return{liveInfo:{banner:"",anchor_img:""}}},created:function(){this.getLiveInfo()},methods:{getLiveInfo:function(){var e=this;this.$api.sendRequest({url:"/live/api/live/info",success:function(t){0==t.code&&t.data?(e.liveInfo=t.data,e.getLiveStatus()):e.liveInfo=null}})},entryRoom:function(e){wx.navigateTo({url:"plugin-private://wx2b03c6e691cd7370/pages/live-player-plugin?room_id=".concat(e)})},getLiveStatus:function(){var e=this,t=requirePlugin("live-player-plugin");t.getLiveStatus({room_id:this.liveInfo.roomid}).then((function(t){var n=t.liveStatus;n&&n!=e.liveInfo.live_status&&e.changeLiveStatus(n)})).catch((function(e){console.log("get live status",e)}));var n=setInterval((function(){t.getLiveStatus({room_id:e.liveInfo.roomid}).then((function(t){var i=t.liveStatus;i&&i!=e.liveInfo.live_status&&e.changeLiveStatus(i),e.$util.inArray(i,[103,104,106,107])&&clearInterval(n)})).catch((function(e){console.log("get live status",e)}))}),6e4)},changeLiveStatus:function(e){var t=this;this.$api.sendRequest({url:"/live/api/live/modifyLiveStatus",data:{room_id:this.liveInfo.roomid,status:e},success:function(e){0==e.code&&t.getLiveInfo()}})}}};t.default=i},e856:function(e,t,n){"use strict";var i,o=function(){var e=this,t=e.$createElement,n=(e._self._c,e.$util.img(e.liveInfo.banner)),i=e.$util.img("upload/uniapp/live_default_banner.png"),o=e.$util.img(e.liveInfo.anchor_img),a=e.$util.getDefaultImage();e._isMounted||(e.e0=function(t){e.liveInfo.banner=e.$util.img("upload/uniapp/live_default_banner.png")},e.e1=function(t){e.liveInfo.anchor_img=e.$util.getDefaultImage().default_headimg}),e.$mp.data=Object.assign({},{$root:{g0:n,g1:i,g2:o,g3:a}})},a=[];n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}))},eff4:function(e,t,n){"use strict";n.r(t);var i=n("bded"),o=n("a8fe");for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("2c39"),n("abfc");var r,u=n("f0c5"),c=Object(u["a"])(o["default"],i["b"],i["c"],!1,null,"616e4c54",null,!1,i["a"],r);t["default"]=c.exports}},[["65c3","common/runtime","common/vendor"]]]);